# apiVersion: v1
# kind: ConfigMap
# metadata:
#   namespace: monitoring  # Change this to your desired namespace
#   name: grafana-k8s-resources-cluster
#   labels:
#     grafana_dashboard: "1"
#     app: grafana
# data:
#   k8s-resources-cluster.json: |-
#     {
#       "editable": true,
#       "links": [
#         {
#           "asDropdown": true,
#           "includeVars": true,
#           "keepTime": true,
#           "tags": ["kubernetes-mixin"],
#           "targetBlank": false,
#           "title": "Kubernetes",
#           "type": "dashboards"
#         }
#       ],
#       "panels": [
#         {
#           "datasource": {"type": "datasource", "uid": "-- Mixed --"},
#           "fieldConfig": {"defaults": {"unit": "percentunit"}},
#           "gridPos": {"h": 3, "w": 4, "x": 0, "y": 0},
#           "id": 1,
#           "interval": "1m",
#           "options": {"colorMode": "none"},
#           "pluginVersion": "v11.4.0",
#           "targets": [
#             {
#               "datasource": {"type": "prometheus", "uid": "${datasource}"},
#               "expr": "cluster:node_cpu:ratio_rate5m{cluster=\"$cluster\"}",
#               "instant": true
#             }
#           ],
#           "title": "CPU Utilisation",
#           "type": "stat"
#         },
#         {
#           "datasource": {"type": "datasource", "uid": "-- Mixed --"},
#           "fieldConfig": {"defaults": {"unit": "percentunit"}},
#           "gridPos": {"h": 3, "w": 4, "x": 4, "y": 0},
#           "id": 2,
#           "interval": "1m",
#           "options": {"colorMode": "none"},
#           "pluginVersion": "v11.4.0",
#           "targets": [
#             {
#               "datasource": {"type": "prometheus", "uid": "${datasource}"},
#               "expr": "sum(namespace_cpu:kube_pod_container_resource_requests:sum{cluster=\"$cluster\"}) / sum(kube_node_status_allocatable{job=\"kube-state-metrics\",resource=\"cpu\",cluster=\"$cluster\"})",
#               "instant": true
#             }
#           ],
#           "title": "CPU Requests Commitment",
#           "type": "stat"
#         },
#         {
#           "datasource": {"type": "datasource", "uid": "-- Mixed --"},
#           "fieldConfig": {"defaults": {"unit": "percentunit"}},
#           "gridPos": {"h": 3, "w": 4, "x": 8, "y": 0},
#           "id": 3,
#           "interval": "1m",
#           "options": {"colorMode": "none"},
#           "pluginVersion": "v11.4.0",
#           "targets": [
#             {
#               "datasource": {"type": "prometheus", "uid": "${datasource}"},
#               "expr": "sum(namespace_cpu:kube_pod_container_resource_limits:sum{cluster=\"$cluster\"}) / sum(kube_node_status_allocatable{job=\"kube-state-metrics\",resource=\"cpu\",cluster=\"$cluster\"})",
#               "instant": true
#             }
#           ],
#           "title": "CPU Limits Commitment",
#           "type": "stat"
#         },
#         {
#           "datasource": {"type": "datasource", "uid": "-- Mixed --"},
#           "fieldConfig": {"defaults": {"unit": "percentunit"}},
#           "gridPos": {"h": 3, "w": 4, "x": 12, "y": 0},
#           "id": 4,
#           "interval": "1m",
#           "options": {"colorMode": "none"},
#           "pluginVersion": "v11.4.0",
#           "targets": [
#             {
#               "datasource": {"type": "prometheus", "uid": "${datasource}"},
#               "expr": "1 - sum(:node_memory_MemAvailable_bytes:sum{cluster=\"$cluster\"}) / sum(node_memory_MemTotal_bytes{job=\"node-exporter\",cluster=\"$cluster\"})",
#               "instant": true
#             }
#           ],
#           "title": "Memory Utilisation",
#           "type": "stat"
#         },
#         {
#           "datasource": {"type": "datasource", "uid": "-- Mixed --"},
#           "fieldConfig": {"defaults": {"unit": "percentunit"}},
#           "gridPos": {"h": 3, "w": 4, "x": 16, "y": 0},
#           "id": 5,
#           "interval": "1m",
#           "options": {"colorMode": "none"},
#           "pluginVersion": "v11.4.0",
#           "targets": [
#             {
#               "datasource": {"type": "prometheus", "uid": "${datasource}"},
#               "expr": "sum(namespace_memory:kube_pod_container_resource_requests:sum{cluster=\"$cluster\"}) / sum(kube_node_status_allocatable{job=\"kube-state-metrics\",resource=\"memory\",cluster=\"$cluster\"})",
#               "instant": true
#             }
#           ],
#           "title": "Memory Requests Commitment",
#           "type": "stat"
#         },
#         {
#           "datasource": {"type": "datasource", "uid": "-- Mixed --"},
#           "fieldConfig": {"defaults": {"unit": "percentunit"}},
#           "gridPos": {"h": 3, "w": 4, "x": 20, "y": 0},
#           "id": 6,
#           "interval": "1m",
#           "options": {"colorMode": "none"},
#           "pluginVersion": "v11.4.0",
#           "targets": [
#             {
#               "datasource": {"type": "prometheus", "uid": "${datasource}"},
#               "expr": "sum(namespace_memory:kube_pod_container_resource_limits:sum{cluster=\"$cluster\"}) / sum(kube_node_status_allocatable{job=\"kube-state-metrics\",resource=\"memory\",cluster=\"$cluster\"})",
#               "instant": true
#             }
#           ],
#           "title": "Memory Limits Commitment",
#           "type": "stat"
#         }
#       ],
#       "refresh": "10s",
#       "schemaVersion": 39,
#       "tags": ["kubernetes-mixin"],
#       "templating": {
#         "list": [
#           {
#             "current": {"selected": true, "text": "default", "value": "default"},
#             "hide": 0,
#             "label": "Data source",
#             "name": "datasource",
#             "query": "prometheus",
#             "regex": "",
#             "type": "datasource"
#           },
#           {
#             "datasource": {"type": "prometheus", "uid": "${datasource}"},
#             "hide": 2,
#             "label": "cluster",
#             "name": "cluster",
#             "query": "label_values(up{job=\"kubelet\", metrics_path=\"/metrics/cadvisor\"}, cluster)",
#             "refresh": 2,
#             "sort": 1,
#             "type": "query",
#             "allValue": ".*"
#           }
#         ]
#       },
#       "time": {"from": "now-1h", "to": "now"},
#       "timezone": "browser",
#       "title": "Kubernetes / Compute Resources / Cluster",
#       "uid": "efa86fd1d0c121a26444b636a3f509a8"
#     }